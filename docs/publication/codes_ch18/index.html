<!DOCTYPE html>
<html lang="zh-cn">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.54.0" />
  <meta name="author" content="学 R：零基础学习 R 语言">
  <meta name="description" content="赵鹏 李怡 著">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/xuer/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/xuer/css/bootstrap.min.css">
  <link rel="stylesheet" href="/xuer/css/font-awesome.min.css">
  <link rel="stylesheet" href="/xuer/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/xuer/css/hugo-academic.css">
  

  <link rel="alternate" href="https://pzhaonet.github.io/xuer/index.xml" type="application/rss+xml" title="学 R ">
  <link rel="feed" href="https://pzhaonet.github.io/xuer/index.xml" type="application/rss+xml" title="学 R ">

  <link rel="icon" type="image/png" href="/xuer/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/xuer/img/apple-touch-icon.png">

  <link rel="canonical" href="https://pzhaonet.github.io/xuer/publication/codes_ch18/">

  

  <title>示例代码（第十八章 用 R 进行基础统计（二）：均值比较和方差分析） | 学 R </title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">切换导航</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/xuer/">学 R </a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/xuer/#about">
            
            <span>简介</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/xuer/#posts">
            
            <span>书友之窗</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/xuer/#help">
            
            <span>辅助资料</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/xuer/#authors">
            
            <span>作者简介</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>

<div class="pub" itemscope itemtype="http://schema.org/CreativeWork">

  

  <div class="container pub-title">
    <h1 itemprop="name">示例代码（第十八章 用 R 进行基础统计（二）：均值比较和方差分析）</h1>
    <span class="pub-authors" itemprop="author">
      
    </span>
    <span class="pull-right">
      
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fpzhaonet.github.io%2fxuer%2fpublication%2fcodes_ch18%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81%ef%bc%88%e7%ac%ac%e5%8d%81%e5%85%ab%e7%ab%a0%20%e7%94%a8%20R%20%e8%bf%9b%e8%a1%8c%e5%9f%ba%e7%a1%80%e7%bb%9f%e8%ae%a1%ef%bc%88%e4%ba%8c%ef%bc%89%ef%bc%9a%e5%9d%87%e5%80%bc%e6%af%94%e8%be%83%e5%92%8c%e6%96%b9%e5%b7%ae%e5%88%86%e6%9e%90%ef%bc%89&amp;url=https%3a%2f%2fpzhaonet.github.io%2fxuer%2fpublication%2fcodes_ch18%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpzhaonet.github.io%2fxuer%2fpublication%2fcodes_ch18%2f&amp;title=%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81%ef%bc%88%e7%ac%ac%e5%8d%81%e5%85%ab%e7%ab%a0%20%e7%94%a8%20R%20%e8%bf%9b%e8%a1%8c%e5%9f%ba%e7%a1%80%e7%bb%9f%e8%ae%a1%ef%bc%88%e4%ba%8c%ef%bc%89%ef%bc%9a%e5%9d%87%e5%80%bc%e6%af%94%e8%be%83%e5%92%8c%e6%96%b9%e5%b7%ae%e5%88%86%e6%9e%90%ef%bc%89"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fpzhaonet.github.io%2fxuer%2fpublication%2fcodes_ch18%2f&amp;title=%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81%ef%bc%88%e7%ac%ac%e5%8d%81%e5%85%ab%e7%ab%a0%20%e7%94%a8%20R%20%e8%bf%9b%e8%a1%8c%e5%9f%ba%e7%a1%80%e7%bb%9f%e8%ae%a1%ef%bc%88%e4%ba%8c%ef%bc%89%ef%bc%9a%e5%9d%87%e5%80%bc%e6%af%94%e8%be%83%e5%92%8c%e6%96%b9%e5%b7%ae%e5%88%86%e6%9e%90%ef%bc%89"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81%ef%bc%88%e7%ac%ac%e5%8d%81%e5%85%ab%e7%ab%a0%20%e7%94%a8%20R%20%e8%bf%9b%e8%a1%8c%e5%9f%ba%e7%a1%80%e7%bb%9f%e8%ae%a1%ef%bc%88%e4%ba%8c%ef%bc%89%ef%bc%9a%e5%9d%87%e5%80%bc%e6%af%94%e8%be%83%e5%92%8c%e6%96%b9%e5%b7%ae%e5%88%86%e6%9e%90%ef%bc%89&amp;body=https%3a%2f%2fpzhaonet.github.io%2fxuer%2fpublication%2fcodes_ch18%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


    </span>
  </div>

</div>
<div class="article-container">

  

  <h3>摘要</h3>
  <p class="pub-abstract" itemprop="text"></p>

  
  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading">类型</div>
        <div class="col-xs-12 col-sm-9">
          
          <a href="/xuer/publication/#6">
            Book chapter
          </a>
          
        </div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>
  

  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading">出版物</div>
        <div class="col-xs-12 col-sm-9"></div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>

  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading">日期</div>
        <div class="col-xs-12 col-sm-9" itemprop="datePublished">
          March, 2017
        </div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>

  <div class="row" style="padding-top: 10px">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading" style="line-height:34px;">链接</div>
        <div class="col-xs-12 col-sm-9">

          












        </div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>

  <div class="space-below"></div>

  <div class="article-style">

<h2 id="第十八章-用-r-进行基础统计-二-均值比较和方差分析">第十八章 用 R 进行基础统计（二）：均值比较和方差分析</h2>

<pre><code>myco2&lt;-co2[1:12]
myco2
t.test(myco2,mu=316.45)
myco2.t1 &lt;- co2[1:12] # 1959年的观测数据
myco2.t2 &lt;- co2[13:24] # 1960年的观测数据
t.test(myco2.t1,myco2.t2)
myco2.t1 &lt;- co2[1:12] # 1959年的观测数据
myco2.t3 &lt;- co2[97:108] # 1965年的观测数据
t.test(myco2.t1,myco2.t3)

require(graphics) # 学生的睡眠数据
with(sleep, t.test(extra[group == 1], extra[group == 2]))
sleep 
t.test(extra ~ group, data = sleep) 
require(graphics)##学生的睡眠数据
with(sleep, t.test(extra[group == 1], extra[group == 2]))
t.test(extra ~ group, data = sleep,paired=TRUE)

attach(airquality)
Month &lt;- factor(Month, labels = month.abb[5:9])
pairwise.t.test(Ozone, Month)
pairwise.t.test(Ozone, Month, p.adj = &quot;bonf&quot;)
pairwise.t.test(Ozone, Month, pool.sd = FALSE)
detach()

oneway.test(weight~feed,data=chickwts, var.equal=T)
oneway.test(extra ~ group, data = sleep)
oneway.test(extra ~ group, data = sleep, var.equal = TRUE)
summary(aov(weight~feed,data=chickwts))
library(geepack)
data(dietox)
weight&lt;-aov(Weight~Cu+Evit,data=dietox)
summary(weight)

data(dietox)
weight&lt;-aov(Weight~Cu+Evit+Cu*Evit,data=dietox)
summary(weight)
data(seizure)
seiz.l &lt;- reshape(seizure, 
    varying = list(c(&quot;base&quot;,&quot;y1&quot;, &quot;y2&quot;, &quot;y3&quot;, &quot;y4&quot;)),
    v.names=&quot;y&quot;, times = 0:4, direction = &quot;long&quot;)
seiz.l &lt;- seiz.l[order(seiz.l$id, seiz.l$time),]
seiz.l$t &lt;- ifelse(seiz.l$time == 0, 8, 2)
seiz.l$x &lt;- ifelse(seiz.l$time == 0, 0, 1)
result &lt;- aov(y ~ x + trt + x * trt, data=seiz.l)
summary(result)
data(dietox)
weight&lt;-aov(Weight~Cu+Time+Cu*Time,data=dietox)
summary(weight)
wilcox.test(airquality$Ozone, mu = 36, 
    subset = Month %in% c(5, 8), exact = NULL, 
    correct = TRUE,conf.int = FALSE, conf.level = 0.95)
require(graphics)
x &lt;- c(1.83,  0.5,  1.62,  2.48, 1.68, 1.88, 1.55, 3.06, 1.3)
y &lt;- c(0.878, 0.647,0.598, 2.05, 1.06, 1.29, 1.06, 3.14,1.29)
wilcox.test(x, y, paired = TRUE, alternative = &quot;greater&quot;)
wilcox.test(y - x, alternative = &quot;less&quot;)
wilcox.test(y - x, alternative = &quot;less&quot;,
            exact = FALSE, correct = FALSE)
x&lt;-randu$x
y&lt;-randu$y
wilcox.test(x,y,paired=FALSE) # Wilcox秩和检验
wilcox.test(x,y,paired =TRUE) # Mann-Whitney U检验
boxplot(weight~group, data=PlantGrowth)

kruskal.test(weight~group, data=PlantGrowth)
RoundingTimes &lt;-  matrix(c(5.40, 5.50, 5.55,
                           5.85, 5.70, 5.75,
                           5.20, 5.60, 5.50,
                           5.55, 5.50, 5.40,
                           5.90, 5.85, 5.70,
                           5.45, 5.55, 5.60,
                           5.40, 5.40, 5.35,
                           5.45, 5.50, 5.35,
                           5.25, 5.15, 5.00,
                           5.85, 5.80, 5.70,
                           5.25, 5.20, 5.10,
                           5.65, 5.55, 5.45,
                           5.60, 5.35, 5.45,
                           5.05, 5.00, 4.95,
                           5.50, 5.50, 5.40,
                           5.45, 5.55, 5.50,
                           5.55, 5.55, 5.35,
                           5.45, 5.50, 5.55,
                           5.50, 5.45, 5.25,
                           5.65, 5.60, 5.40,
                           5.70, 5.65, 5.55,
                           6.30, 6.30, 6.25),
    nrow = 22,byrow = TRUE,
    dimnames = list(1:22,
        c(&quot;Round Out&quot;, &quot;Narrow Angle&quot;, &quot;Wide Angle&quot;)))
friedman.test(RoundingTimes)

data(iris)#鸢尾花数据集
head(iris)#查看下数据集
iris.data&lt;-iris[,-5]#去掉最后一列，非数字变量
cor(iris.data)
head(airquality)
cor.test(airquality$Wind,airquality$Temp)
cor.test(airquality$Wind,airquality$Temp,method = &quot;kendall&quot;)
if(!require(psych)) install.packages(&quot;psych&quot;)
library(psych)
corr.test(iris.data)
corr.test(iris.data)$r
corr.test(iris.data)$p
print(corr.test(iris.data)$r,digits=3)
if(!require(graphics)) install.packages(graphics)
require(graphics)
pairs(iris)
if(!require(corrplot)) install.packages(&quot;corrplot&quot;)
library(psych)
library(corrplot)
par(cex = 0.5)
corrplot(corr.test(iris.data)$r)

data(mtcars)
M &lt;- cor(mtcars)
# different color series
col1 &lt;- colorRampPalette(c(&quot;#7F0000&quot;,&quot;red&quot;,&quot;#FF7F00&quot;,
    &quot;yellow&quot;,&quot;white&quot;, &quot;cyan&quot;, &quot;#007FFF&quot;, &quot;blue&quot;,&quot;#00007F&quot;))
col2 &lt;- colorRampPalette(c(&quot;#67001F&quot;, &quot;#B2182B&quot;, &quot;#D6604D&quot;, 
    &quot;#F4A582&quot;, &quot;#FDDBC7&quot;, &quot;#FFFFFF&quot;, &quot;#D1E5F0&quot;, &quot;#92C5DE&quot;, 
    &quot;#4393C3&quot;, &quot;#2166AC&quot;, &quot;#053061&quot;))
col3 &lt;- colorRampPalette(c(&quot;red&quot;, &quot;white&quot;, &quot;blue&quot;))
col4 &lt;- colorRampPalette(c(&quot;#7F0000&quot;,&quot;red&quot;,&quot;#FF7F00&quot;,
    &quot;yellow&quot;,&quot;#7FFF7F&quot;, &quot;cyan&quot;, &quot;#007FFF&quot;, &quot;blue&quot;,&quot;#00007F&quot;))
wb &lt;- c(&quot;white&quot;,&quot;black&quot;)

library(corrplot)
par(mfrow = c(2,1))
corrplot(M, method = &quot;number&quot;)
corrplot(M)

corrplot(M, order = &quot;AOE&quot;, col = col1(20), cl.length = 21, 
         addCoef.col = &quot;grey&quot;)

par(mfrow = c(3,1))
corrplot(M, method = &quot;ellipse&quot;, col = col1(200),order =&quot;AOE&quot;)
corrplot(M, method = &quot;shade&quot;, col = col3(20),order = &quot;AOE&quot;)
corrplot(M, method = &quot;pie&quot;, order = &quot;AOE&quot;)

par(mfrow = c(2,1))
corrplot(M, col = wb, order=&quot;AOE&quot;, outline=TRUE, cl.pos=&quot;n&quot;)
corrplot(M, col = wb, bg=&quot;gold2&quot;,  order=&quot;AOE&quot;, cl.pos=&quot;n&quot;)

corrplot(M,order = &quot;AOE&quot;, type = &quot;upper&quot;, tl.pos = &quot;d&quot;)
corrplot(M,add = TRUE, type = &quot;lower&quot;, method = &quot;ell&quot;, 
    order = &quot;AOE&quot;, diag=FALSE, tl.pos= &quot;n&quot;, cl.pos = &quot;n&quot;)
par(mfrow = c(2,1))

ran &lt;- round(matrix(runif(225, -100,100), 15))
corrplot(ran, is.corr=FALSE)
corrplot(ran, is.corr=FALSE, cl.lim=c(-100, 100))
par(mfrow = c(3,1))

corrplot(M, order=&quot;AOE&quot;, tl.srt=60)
corrplot(M, order=&quot;AOE&quot;, diag=FALSE, tl.pos=&quot;d&quot;)
corrplot(M, order=&quot;AOE&quot;, type=&quot;lower&quot;, cl.pos=&quot;b&quot;)
cor.mtest &lt;- function(mat, conf.level = 0.95){
  mat &lt;- as.matrix(mat)
  n &lt;- ncol(mat)
  p.mat &lt;- lowCI.mat &lt;- uppCI.mat &lt;- matrix(NA, n, n)
  diag(p.mat) &lt;- 0
  diag(lowCI.mat) &lt;- diag(uppCI.mat) &lt;- 1
  for(i in 1:(n-1)){
    for(j in (i+1):n){
      tmp &lt;- cor.test(mat[,i], mat[,j], 
                      conf.level = conf.level)
      p.mat[i,j] &lt;- p.mat[j,i] &lt;- tmp$p.value
      lowCI.mat[i,j] &lt;- lowCI.mat[j,i] &lt;- tmp$conf.int[1]
      uppCI.mat[i,j] &lt;- uppCI.mat[j,i] &lt;- tmp$conf.int[2]
    }
  }
  return(list(p.mat, lowCI.mat, uppCI.mat))
}

res1 &lt;- cor.mtest(mtcars,0.95)
res2 &lt;- cor.mtest(mtcars,0.99)

par(mfrow = c(3,1))
corrplot(M, p.mat = res1[[1]], sig.level = 0.2)
corrplot(M, p.mat = res1[[1]], insig = &quot;p-value&quot;,
         sig.level= -1) # add all p-values
corrplot(M, p.mat = res1[[1]], order = &quot;hclust&quot;, 
         insig = &quot;pch&quot;, addrect = 3)

if(!require(ellipse)) install.packages('ellipse')
library(ellipse)
library(psych)
mycol = colors()[as.vector(apply(corr.test(
  iris.data)$r, 2, rank))]
plotcorr(corr.test(iris.data)$r, 
         col = mycol, mar = rep(0, 4))
x &lt;- c(44.4, 45.9, 41.9, 53.3, 44.7, 44.1, 50.7, 45.2, 60.1)
y &lt;- c( 2.6,  3.1,  2.5,  5.0,  3.6,  4.0,  5.2,  2.8,  3.8)
par(mfrow = c(2, 1), mar = c(2, 4, 0.1, 0.1))
plot(x)
lines(x)
plot(y)
lines(y)
cor.test(x, y, method = &quot;spearm&quot;, alternative = &quot;g&quot;)
cov(x,y)
cor.test(x, y, method = &quot;spearm&quot;, alternative = &quot;g&quot;)
x &lt;- as.data.frame(x) # 这个命令要求x是数据框或者矩阵
cov.wt(x, wt = rep(1/nrow(x), nrow(x)), cor = FALSE,
       center = TRUE, method = c(&quot;unbiased&quot;, &quot;ML&quot;))
xy &lt;- cbind(x = 1:10, y = c(1:3, 8:5, 8:10))
w1 &lt;- c(0,0,0,1,1,1,1,1,0,0)
cov.wt(xy, wt = w1) # i.e. method = &quot;unbiased&quot;
cov.wt(xy, wt = w1, method = &quot;ML&quot;, cor = TRUE)
knitr::opts_chunk$set(tidy = FALSE)
</code></pre>
</div>

</div>

<div class="container">
  <nav>
  <ul class="pager">
    

    
    <li class="next"><a href="https://pzhaonet.github.io/xuer/publication/codes_ch17/">示例代码（第十七章 用 R 进行基础统计（一）：概率分布检验） <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 赵鹏 李怡 &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/xuer/js/jquery-1.12.3.min.js"></script>
    <script src="/xuer/js/bootstrap.min.js"></script>
    <script src="/xuer/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/xuer/js/hugo-academic.js"></script>
    

    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>

